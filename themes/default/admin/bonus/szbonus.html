<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>玩家分类</title> 
	#{include file ="jscss.html"};
	<script type="text/javascript">
		$(function(){
			   
			$("#szbonus_datagrid").datagrid({
				title:"分红设置列表",
				url:"#{$ctx}/admin/bonus/szbonus.php?act=list",
				fitColumns:true,
				rownumbers:true,
				pagination:true,
				toolbar:easyUi.initButton(
				[ 
					 {name:'edit',text:"修改玩家分红",handler:updateUser},
					 {name:'remove',text:"删除玩家分红",handler:deleteUser},
				]),
			}); 
			
 
		}); 
		
		function saveUser () { 
			var act ="update";
			 
			easyUi.formSubmit({
				formId : "#szbonus_form",
				submit : function() {
				},
				success : function(data) {
					msgSuccess(data);
					$("#szbonus_datagrid").datagrid("reload");
					$("#szbonus_form_dlg").dialog("close");
				},
				prefix : "",
				params : {"act":act}
			});
		}
		function updateUser () { 
			var row = easyUi.selectDatagrid("#szbonus_datagrid");
			var result = easyUi.loadForm("#szbonus_form", "#szbonus_datagrid", "");
			if(!result) {
				return ;
			}
			$("#szbonus_form_dlg").dialog({
				title : "修改玩家分红"
			}).dialog("open");
		}
		function deleteUser () {
			var rows = $('#szbonus_datagrid').datagrid('getSelections');	 
			var url = "#{$ctx}/admin/bonus/szbonus.php?act=delete"; 
			easyUi.del("#szbonus_datagrid", "id", url, function (data){
				$("#szbonus_datagrid").datagrid("reload");
				msgSuccess(data);
			});
		}
		function search () {
			var p = {}; 
			$("#search_form").find("input").each(function(){
				p[this.name]=this.value;
			});
			
			$("#szbonus_datagrid").datagrid({
				queryParams:p
			});
		}  
	</script>
</head>
<body>

	<div class="easyui-panel" title="查询" 
		data-options="iconCls:'icon-save',collapsible:true">
		<form id="search_form" method="post">
			<table > 
				<tr>
			    <td>起始日期：
				<input type="text" class="Wdate" name="stardate" onfocus="WdatePicker({isShowClear:false,readOnly:true})"/>
				--<input type="text" class="Wdate" name="enddate" onfocus="WdatePicker({isShowClear:false,readOnly:true})"/>
				</td>	
					<td>玩家：</td><td><input name="client_logn" value=""/></td> 
					<td>周期：</td><td><input name="szbonus_zq" value=""/></td> 
					<td>比例：</td><td><input name="szbonus_bl" value=""/></td>  
				</tr>				
				<tr>
				<td><a href="javascript:search()" class="easyui-linkbutton">查询</a>
						<a href="#" class="easyui-linkbutton">清空</a></td>
				</tr>
			</table>
		</form>
	</div>
	
	
	<table id= "szbonus_datagrid">
		<thead>
			<tr>
				<th data-options="field:'id',width:80,checkbox:true" >id</th>		
				<th data-options="field:'client_logn',width:80" >分红账号</th>  
				<th data-options="field:'szbonus_bl',width:180" >分红比例</th>
				<th data-options="field:'szbonus_zq',width:80" >分红周期</th> 
				<th data-options="field:'szbonus_qssj',width:180" >起始时间</th> 
				<th data-options="field:'szbonus_ffsj',width:180" >发放时间</th> 
			</tr> 
		</thead>
	</table>
	
	<div id="szbonus_form_dlg" class="easyui-dialog"  closed="true"
		style="width:600px; height: 500px; left: 100px; top: 15px; padding: 10px;" 
		data-options="resizable:true,buttons:'#dic_form_dlg_buttons'">
		<form id="szbonus_form" action="#{$ctx}/admin/bonus/szbonus.php" method="post" >
			<input id="szbonus_id" name="id" type="hidden"/>
			<table>   
				<tr>
					<td>分红比例:</td>
					<td><input class="easyui-numberbox" min="0" max="100" precision="0" required="true" missingMessage="必须0到100之间"  type="text" name="szbonus_bl" data-options="required:true" /></td>
				</tr>
				<tr>
					<td>分红周期:</td>
					<td><input class="easyui-numberbox" min="0" max="365" precision="0" required="true" missingMessage="必须0到365之间"  type="text" name="szbonus_zq" data-options="required:true" /></td>
				</tr>
				<tr>
					<td>起始时间:</td>
					<td>
						<input class="Wdate" type="text"  name="szbonus_qssj"  onFocus="WdatePicker({isShowClear:false,readOnly:true})"/>
					</td>
				</tr>
				<tr>
					<td>发放时间:</td>
					<td>
						<input class="easyui-timespinner" name="szbonus_ffsj"  style="width:80px;" data-options="required:true"> 
					</td>
				</tr>  
				<tr>  
					<td>状态:</td>
					<td>						
					<select id="state" class="easyui-combobox" data-options="required:true"  name="szbonus_isyx" style="width:200px;">						 
						<option value="0">有效</option>
						<option value="1">取消</option>  
					</select>
					</td>
				</tr>  
			</table> 
		</form>	
		<div id="user_form_dlg_buttons">
			<a href="javascript:saveUser()" class="easyui-linkbutton" >提交</a>
			<a href="#" class="easyui-linkbutton" onclick="javascript:$('#szbonus_form_dlg').dialog('close')">关闭</a>
		</div>
	</div>	
	 
</body>
	
</html>